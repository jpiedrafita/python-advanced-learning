

# Mongita

- Conceptually similar to SQLite, except for document databases.
- Mongita is a Python package that implements a subset of the ```pymongo``` API.
- Usage:
	- Embedded database,
	- Unit testing: MongoDB is a server, using Mongita for unit test we get rid of server issues.

# Using Mongita

- First we need to get a client to connect to the Mongita .
- The ```MongitaClientDisk``` will store the database in a folder under the home folder in a folder named ```.mongita```.
	- The location can be specified.
	- If the path does not exists, the db will be crated.
- The databases are dynamic attributes of the client.
- The collections are dynamic attributes of thecdatabase.
- To create a new document, call the ```insert_one``` method on the collection.
	- MongoDB/Mongita documents are conceptually similar to JSON documents, structurally and syntactically. 
	- JSON documents, structurally and syntactically, are similar to Python ```dict```.
	- Therefor, we are able to insert a document into MongoDB/Mongita by passing a ```dict``` to ```insert_one```.
	- There is no need to tell Mongita in advance about the data structure.
- To insert many dictionaries there is the ```insert_many``` function, which takes a ```list``` of ```dict```.

```bash
pip install mongita
```


```python
from mongita import MongitaClientDisk

client = MongitaClientDisk()

# get or create the portfolio database
db = client.portfolio

# get or create the investments collection
investments = db.investments

# insert a document into the investments collection
investments.insert_one({"coin_id": "bitcoin", "currency": "usd", "amount": 1.0})

# insert many
investments.insert_many([{"coin_id": "ethereum", "currency": "usd", "amount": 10.0}, {"coin_id": "solana", "currency": "usd", "amount": 25.0}])
```

- To query the database use  ```find()```, ```find_one()``` with a certain criteria.
- In case there are no matches, it will return ```None```.

```python
# get all documents with a coin_id of bitcoin
bitcoin_investments = investments.find({"coin_id": "bitcoin"})

# get first document with a coin_id of bitcoin
first_bitcoin_investment = investments.find_one({"coin_id": "bitcoin"})

# all documents in the investment collection
all_investments = investments.find({})

# an empty result set will retrun None
no_investments = investments.find({"coin_id": "dogecoin"})
```

- Multiple filter documents is suported by ```pymongo``` only in MonfoDB, not Mongita.

- Like with inserts, we can update one or many.
	- The function takes a filter document and an update document.

```python
# Suposing this is teh JSON representation of the database
[
	{"coin_id": "bitcoin", "amount": 1.0},
	{"coin_id": "bitcoin", "amount": 0.5},
	{"coin_id": "ethereum", "amount": 10.0}
]

# increment all bitcoin investments by 0.1
updates = investments.update_many(
	{"coin_id": "bitcoin"},
	{"$inc": {"amount": 0.1}}
)

```

- Deletes works similar to find

```python
deletes = investment.delete_one({"coin_id": "ethereum"})
```