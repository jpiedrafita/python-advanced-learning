# Introduction

- Generic collections such as a list of tuples can be confusing to work with, particularly in a larger application.
- What if you could use structured Python objects and refer to values by name instead of position?

üß©  **The row_factory attribute**
    
üè≠ **sqlite3 includes the Row row factory**
    
‚ÜîÔ∏è **Transform a tuple into a dictionary-like object**
    
üêç  **You could also use a ```namedtuple``` from the collections module to do this with a namedtuple.**

# Dataclases

- Dataclases eliminate a lot of boilderplate to define a data structure

```python
# Helper class / data transfer object

class Investment:
    def __init__(self, coin_id, currency, amount, sell, date):
        self.coin_id = coin_id
        self.currency = currency
        self.amount = amount
        self.sell = sell
        self.date = date

    def __repr__(self):
        return f"<Investment {self.coin_id} {self.amount:.2f} {self.currency.upper()}>"

# Same class defined as a dataclass

@dataclass
class Investment:
¬† ¬† coin_id: str
¬† ¬† currency: str
¬† ¬† amount: float
¬† ¬† sell: bool
¬† ¬† date: datetime.datetime

	def compute_value(self) -> float:
		return self.amount *get_coin_price(self.coin_id, self.currency)
```


- A row factory is a function that will transform tuples into dataclases.
- Pros:
	- **Clarity**: Each row is directly transformed into an object with attributes instead of magic indexes.
	- **Encapsulation**: Allows encapsulate the parsing logic in a single point.
	- **Less repeated code**: We don't need to manually map row->object in each part of the application.

```python
def investment_row_factory(_, row):
    return Investment(
        coin_id = row[0],
        currency = row[1],
        amount = row[2],
        sell = bool(row[3]),
        date = datetime.datetime.strptime(row[4], "%Y-%m-%d %H:%M:%S.%f")
    )
```

- finally set the row factory of the database
- The results of SQL queries now will be instances of the dataclas

```python
database.row_factory = investment_row_factory
```